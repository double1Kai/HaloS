# 主引导扇区boot
## BIOS（Basic Input Output System）
BIOS在加电自检后，将主引导扇区读到0x7c00的位置，并跳转到这里执行

0x10，BIOS系统调用，显示器相关的功能，将ax设置为3，再调用即可清除屏幕内容

## 主引导扇区结构
- 代码：466B
- 硬盘分区表：64B
- 0x55 和 0xaa

## 主引导扇区功能
读取内核加载器并执行

## 实模式
### 寻址方式 
> 有效地址 = 段地址*16 + 偏移地址

段地址向左移动4位，凑出20位地址

### print
0x10系统调用的子功能0xe0
- ah: 0x0e
- al: 字符
- int 0x10  

## 硬盘读写
- 扇区：硬盘读写的最小单位，最小一个，最多256个  

### 读写模式
- CHS模式：Cylinder/Head/Sector
- LBA模式：Logic Block Address  
采用LBA28模式（28位地址）
### 端口
端口相当于外部设备内部的寄存器  
- 0x1F0：16bit，用于读写数据
- 0x1F1：检测前一个指令的错误
- 0x1F2：读写扇区的数量
- 0x1F3：起始扇区低8位
- 0x1F4：起始扇区中8位
- 0x1F5：起始扇区高8位
- 0x1F6：
    - 0~3位：起始扇区最高4位
    - 4位：0->主盘，1->从盘
    - 6位：0->CHS，1->LBA
    - 5、7位：固定为1
- 0x1F7：out操作
    - 0xEC：识别硬盘
    - 0x20：读硬盘
    - 0x30: 写硬盘
- 0x1F7：in操作/8bit
    - 0位：1->ERR
    - 3位：1->DRQ 数据准备完毕
    - 7位: 1->BSY 硬盘繁忙
** 读硬盘是等硬盘空闲，再读入内存 **
** 写硬盘是先写入内存，再等硬盘空闲 **




